# ================================================
# SNOWFLAKE ACTIVITYSCHEMA BI ENVIRONMENT CONFIG
# ================================================
# Copy this file to .env and fill in your values
# NEVER commit the .env file to version control

# ==========================================
# SNOWFLAKE CONNECTION (REQUIRED)
# ==========================================
# Account identifier (get from Snowflake UI)
# Format: <account>.<region>.<cloud> or <orgname>-<account_name>
SNOWFLAKE_ACCOUNT=ABC12345.us-east-1.aws

# Authentication credentials
SNOWFLAKE_USERNAME=your_username
SNOWFLAKE_PASSWORD=your_password

# Database configuration
SNOWFLAKE_WAREHOUSE=COMPUTE_XS     # X-Small warehouse for development
SNOWFLAKE_DATABASE=ANALYTICS       # Target database
SNOWFLAKE_SCHEMA=ACTIVITY          # Base schema (ACTIVITY_CDESK for extensions)
SNOWFLAKE_ROLE=ACCOUNTADMIN         # Role with necessary permissions

# ==========================================
# DEVELOPMENT VS PRODUCTION
# ==========================================
# For development, use smaller warehouse and dev schemas:
# SNOWFLAKE_WAREHOUSE=COMPUTE_DEV
# SNOWFLAKE_SCHEMA=ACTIVITY_DEV
# SNOWFLAKE_ROLE=BI_DEVELOPER

# ==========================================
# REDIS CACHE (OPTIONAL)
# ==========================================
# If not provided, will use in-memory LRU cache
# REDIS_URL=redis://localhost:6379
# REDIS_PASSWORD=your_redis_password
# REDIS_DB=0
# REDIS_KEY_PREFIX=cdesk:

# ==========================================
# AWS S3 FOR ARTIFACTS (OPTIONAL)
# ==========================================
# Required for storing large query results
# AWS_ACCESS_KEY_ID=AKIA...
# AWS_SECRET_ACCESS_KEY=...
# AWS_REGION=us-east-1
# S3_BUCKET=your-bi-artifacts-bucket
# S3_PREFIX=artifacts/

# ==========================================
# APPLICATION SETTINGS
# ==========================================
NODE_ENV=development                # development | staging | production
LOG_LEVEL=info                     # debug | info | warn | error
PORT=3000                          # MCP server port

# ==========================================
# PERFORMANCE TUNING
# ==========================================
MAX_QUEUE_SIZE=100000              # Max events in NDJSON queue
QUEUE_ROTATION_SIZE=16777216       # 16MB - rotate queue file at this size
QUEUE_ROTATION_TIME=60000          # 60s - rotate queue file after this time
CACHE_MAX_SIZE=10000               # Max items in LRU cache
CACHE_TTL=3600                     # 1 hour - cache expiry in seconds
BATCH_SIZE=1000                    # Events per upload batch
UPLOAD_INTERVAL=5000               # 5s - upload interval in milliseconds

# ==========================================
# SECURITY SETTINGS
# ==========================================
ENABLE_QUERY_VALIDATION=true       # Validate all SQL queries
ENABLE_ROW_LEVEL_SECURITY=true     # Enforce RLS policies
MAX_QUERY_BYTES=10485760           # 10MB - max query result size
ALLOWED_SCHEMAS=ACTIVITY,ACTIVITY_CDESK  # Comma-separated allowed schemas
ENABLE_AUDIT_LOG=true              # Log all queries for audit

# ==========================================
# MONITORING & OBSERVABILITY
# ==========================================
ENABLE_METRICS=true                # Enable Prometheus metrics
METRICS_PORT=9090                  # Prometheus metrics port
ENABLE_TRACING=false               # Enable OpenTelemetry tracing
OTEL_EXPORTER_ENDPOINT=            # OpenTelemetry collector endpoint
HEALTH_CHECK_INTERVAL=30000        # 30s - health check interval

# ==========================================
# RESOURCE LIMITS
# ==========================================
MAX_CONCURRENT_QUERIES=5           # Max parallel Snowflake queries
QUERY_TIMEOUT=30000                # 30s - query timeout in milliseconds
MAX_RETRIES=3                      # Max retry attempts for failed queries
RETRY_DELAY=1000                   # 1s - initial retry delay (exponential backoff)

# ==========================================
# FEATURE FLAGS
# ==========================================
ENABLE_CHAOS_TESTING=false         # Enable chaos testing endpoints
ENABLE_VICTORY_AUDITOR=true        # Enable automatic claim validation
ENABLE_QUERY_SAMPLING=false        # Sample queries when over limit
SAMPLE_RATE=0.1                    # 10% sampling rate when enabled

# ==========================================
# ADVANCED SNOWFLAKE OPTIONS
# ==========================================
# SNOWFLAKE_PRIVATE_KEY_PATH=/path/to/rsa_key.p8  # For key-pair auth
# SNOWFLAKE_PRIVATE_KEY_PASSPHRASE=passphrase      # If key is encrypted
# SNOWFLAKE_SESSION_PARAMETERS={"QUERY_TAG": "cdesk"}
# SNOWFLAKE_PROXY=http://proxy.company.com:8080
# SNOWFLAKE_KEEP_ALIVE=true
# SNOWFLAKE_KEEP_ALIVE_INTERVAL=3600